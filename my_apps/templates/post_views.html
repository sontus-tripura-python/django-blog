{% extends 'base.html' %}
{% load markdownify %}

 {% block body %}
 <div class="post">
   {% if posts.publish_date %}
          <div class="date">
               {{ posts.publish_date }}
          </div>
    {% else %}
     <span class="publish_div">
        <a href="{% url 'post_publish' pk=posts.pk %}" class="publishlink">publish</a>
     </span>


   {% endif%}
   {% if user.is_authenticated %}
   <a href="{% url 'post_edit' pk=posts.pk %}" class="editLink"><i class="fas fa-edit"></i></a>
   <a href="{% url 'post_delete' pk=posts.pk %}" class="btn btn-danger" onclick="return('are you sure want to delete?')">Delete</a>
   {% endif %}
   <h2>{{ posts.title }}</h2>
    <p>{{ posts.text| markdown | safe }}</p>
 </div>
<hr>
<div class="commentbtn">
  <a href="{% url 'add_comment_post' pk=posts.pk %}" class="btn btn-secondary">Add comment</a>
</div>
{% for comment in posts.comments.all %}
{% if user.is_authenticated or comment.approved %}
<div class="commentsection">
  <div class="commentdate">
    {{ comment.created_date }}
  </div>
  {% if not comment.approved or user.is_superuser %}
  <a href="{% url 'comment_approve' pk=comment.pk %}" class="btn btn-success">Approve</a>
  <a href="{% url 'comment_remove' pk=comment.pk %}" class="btn btn-danger">Delete</a>
  {% endif %}
  <p><strong>{{ comment.author }}</strong></p>
  <p>{{ comment.text }}</p>
</div>
  {% endif %}
{% empty %}
<p>No comment yet...</p>
{% endfor %}


{% endblock %}
